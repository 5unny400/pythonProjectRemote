# 分布式锁

基于`setnx`实现的分布式锁存在如下问题：

1. 不可重入：同一个线程无法多次获取同一把锁
2. 不可重试：获取锁只尝试一次就返回false，没有重试机制
3. 超时释放：由于业务执行耗时长，导致锁释放，存在安全隐患
4. 主从一致性：在redis主从集群环境下，主从同步存在一定延迟，一线程从主拿到一把锁，当主宕机时，如果从未及时同步主中的锁数据，其它线程就会去拿到从中的锁，出现问题。

### Redisson

1. https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95
2. https://www.bookstack.cn/read/redisson-wiki-zh/Redisson%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D.md